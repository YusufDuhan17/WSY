{% extends "base.html" %}

{% block title %}Kayıt Başarılı - Şifre Yöneticisi{% endblock %}

{% block head_extra %}
<style>
    .success-container {
        max-width: 800px;
        margin: 0 auto;
    }
    .recovery-info-box {
        background: rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        border-radius: 15px;
        padding: 25px;
        margin: 20px 0;
        border: 2px solid rgba(255, 255, 255, 0.2);
    }
    .recovery-key-box {
        background: rgba(0, 0, 0, 0.4);
        padding: 20px;
        border-radius: 10px;
        margin: 15px 0;
        text-align: center;
    }
    .recovery-key {
        font-family: 'Courier New', monospace;
        font-size: 1.5em;
        font-weight: bold;
        color: #f1c40f;
        letter-spacing: 3px;
        padding: 15px;
        background: rgba(0, 0, 0, 0.5);
        border-radius: 8px;
        margin: 10px 0;
        word-break: break-all;
    }
    .copy-btn {
        margin-top: 10px;
        padding: 10px 20px;
        background: var(--primary-color);
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1em;
    }
    .download-btn {
        margin-top: 10px;
        padding: 12px 25px;
        background: #27ae60;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-size: 1em;
        text-decoration: none;
        display: inline-block;
    }
    .warning-banner {
        background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
        padding: 20px;
        border-radius: 15px;
        margin-bottom: 30px;
        color: white;
        text-align: center;
    }
</style>
{% endblock %}

{% block content %}
    <div class="success-container">
        <header class="content-header">
            <h1 style="color: #4CAF50;">
                <i class="fas fa-check-circle"></i> Kayıt Başarılı!
            </h1>
            <p>Hesabınız başarıyla oluşturuldu. Aşağıdaki kurtarma bilgilerinizi mutlaka kaydedin!</p>
        </header>

        <div class="warning-banner">
            <h3 style="margin: 0 0 10px 0;">
                <i class="fas fa-exclamation-triangle"></i> ÖNEMLİ UYARI
            </h3>
            <p style="margin: 0; line-height: 1.6;">
                Aşağıdaki kurtarma bilgileri sadece bir kez gösterilecek! 
                Bu bilgileri kaydetmezseniz, şifrenizi unuttuğunuzda hesabınıza erişemezsiniz.
                Lütfen bu bilgileri güvenli bir yerde saklayın.
            </p>
        </div>

        {% if recovery_key %}
        <div class="recovery-info-box">
            <h3 style="color: white; margin-bottom: 15px;">
                <i class="fas fa-key"></i> Kurtarma Anahtarınız (Recovery Key)
            </h3>
            <div class="recovery-key-box">
                <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 10px;">
                    Aşağıdaki kurtarma anahtarınızı bir yere not edin:
                </p>
                <div class="recovery-key" id="recovery-key">{{ recovery_key }}</div>
                <button class="copy-btn" onclick="copyRecoveryKey()">
                    <i class="fas fa-copy"></i> Kopyala
                </button>
            </div>
            <div class="info-box" style="background: rgba(241, 196, 15, 0.2); border-left: 4px solid #f1c40f; padding: 15px; border-radius: 8px; margin-top: 15px; color: white;">
                <i class="fas fa-info-circle"></i> 
                <strong>Nasıl Kullanılır:</strong> Şifrenizi unuttuğunuzda, "Şifremi Unuttum" sayfasında 
                bu kurtarma anahtarını girerek şifrenizi sıfırlayabilirsiniz.
            </div>
        </div>
        {% endif %}

        {% if key_file %}
        <div class="recovery-info-box">
            <h3 style="color: white; margin-bottom: 15px;">
                <i class="fas fa-file-alt"></i> Anahtar Dosyanız (Key File)
            </h3>
            <div class="recovery-key-box">
                <p style="color: rgba(255, 255, 255, 0.9); margin-bottom: 15px;">
                    Aşağıdaki butona tıklayarak anahtar dosyanızı indirin:
                </p>
                <button onclick="downloadKeyFile()" class="download-btn">
                    <i class="fas fa-download"></i> Key File'ı İndir
                </button>
            </div>
            <div class="info-box" style="background: rgba(241, 196, 15, 0.2); border-left: 4px solid #f1c40f; padding: 15px; border-radius: 8px; margin-top: 15px; color: white;">
                <i class="fas fa-info-circle"></i> 
                <strong>Nasıl Kullanılır:</strong> Şifrenizi unuttuğunuzda, "Şifremi Unuttum" sayfasında 
                bu key file'ı yükleyerek şifrenizi sıfırlayabilirsiniz. Dosyayı güvenli bir yerde saklayın!
            </div>
        </div>
        
        <script>
            function downloadKeyFile() {
                const content = {{ key_file.content|tojson|safe }};
                const filename = "{{ key_file.filename }}";
                const blob = new Blob([JSON.stringify(content, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }
        </script>
        {% endif %}

        <div style="text-align: center; margin-top: 30px;">
            <a href="{{ url_for('login') }}" class="button primary-button" style="font-size: 1.1em; padding: 15px 30px;">
                <i class="fas fa-sign-in-alt"></i> Giriş Yap
            </a>
        </div>
    </div>

    <script>
        function copyRecoveryKey() {
            const key = document.getElementById('recovery-key').textContent;
            navigator.clipboard.writeText(key).then(() => {
                alert('Kurtarma anahtarı kopyalandı!');
            }).catch(err => {
                console.error('Kopyalama hatası:', err);
                alert('Kopyalama başarısız. Lütfen manuel olarak kopyalayın.');
            });
        }
    </script>
{% endblock %}

